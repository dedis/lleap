package ch.epfl.dedis.lleap;

import java.math.BigInteger;
import java.security.KeyFactory;
import java.security.NoSuchAlgorithmException;
import java.security.PrivateKey;
import java.security.PublicKey;
import java.security.interfaces.RSAPublicKey;
import java.security.spec.InvalidKeySpecException;
import java.security.spec.PKCS8EncodedKeySpec;

import ch.epfl.dedis.lib.crypto.Hex;

/**
 * LLEAPKey holds the private key used to write to the skipchain. Only holders of this private key are allowed to
 * store new values on the skipchain.
 */
public class LLEAPKey implements RSAPublicKey {
    /**
     * Returns the private key that can be used to sign key/value pairs when they are stored on the
     * skipchain.
     *
     * @return PrivateKey
     */
    public static PrivateKey getPrivate() {
        try {
            KeyFactory kf = KeyFactory.getInstance("RSA");
            return kf.generatePrivate(new PKCS8EncodedKeySpec(Hex.parseHexBinary(LLEAPKey.privateKeyStr)));
        } catch (NoSuchAlgorithmException | InvalidKeySpecException e) {
            throw new RuntimeException(e.getMessage());
        }
    }

    public static PublicKey getPublic() {
        return new LLEAPKey();
    }

    @Override
    public String getAlgorithm() {
        return "RSA";
    }

    public byte[] getEncoded() {
        BigInteger bi = new BigInteger("6449899354536379733359492255915819504744640999476334413976419437138758720541604440832366460329576231186998522856440957722539677020280415934820003729460743108320006234926840692492873926464336767110720105137843884412419534253696370930095621168307316447274341691205398414209761616703887449197482900945777981231523286298114859861936082846523344292356935555954108794371174610991546041899083751358363455271439495320099242957370831860209874803127497486638643052956679274481555359137713714546134343472284383706500933626331497716480408509488338360381265735580009536955414008681469794840234049182799730049901206224309599355852203873533893217282943409809678359939178055431770007647464260717593618816723140193703267637723343191472195148045465316304912735166726327908840883843856214742325989284317927629901209962534943699681111953021317713938033639805965331414934163589615443632751761179159359742341216716537494530777024314652198995826142527699195362278290607660454702530526990536560645725391406977638548767873699410110829382165568689311167881504398986350587650968341382377920003720909745750039432194149571445173749375604952395886489811514186017110022339914347800056035881711451249886046743071884700586804745817252178629282961320196543390918588906675962857040051675013652337036934297135083796973910579039387785366277048784633369284640769");
        return bi.toByteArray();
    }

    @Override
    public String getFormat() {
        return "X.509";
    }

    @Override
    public BigInteger getModulus() {
        String modulus = "524559323157370149871140666473665350534556013783207381258678280220069294726411674069604369532235087142300581801463643511157692689234132799976082610119268917264833055400251546700604655045276095303939396071083132284896756092352058740825993212813018625443563804875364718987729935766822827915045725086199943427209586063877644750620149486342048881561991592599392110714423899328057705215834646243095657054504850042400229800443815973626141013700658585388819273293570279991408924349791093951544020932627549517536311305251856871875484425298427474398183405730144429104925031457625172975735736703758836828090929608034204699618635013493294685754714218017338421809992211158988287087255635668982509214403367489234737489727057448936827773908231799698349677541585895007737314487098137068058117213283795503383908810069073514797814119860268863728528829255676393887207683246481494974464483350428978338732211988981760693111322789648259608164118883700312659845910377525869699147843595341014925637402609200087381259460023523188574466835638836238134923095810443258208364386782977077165019361409264468763816279810029964707860388251278040558499661136856931743967214132413437486771546206411334956075651746916826342942399640367006729112427891154446558029232107";
        return new BigInteger(modulus);
    }

    @Override
    public BigInteger getPublicExponent() {
        // The most common prime number used for RSA
        return new BigInteger("65537");
    }


    // Created private key by the TestSkipchainRPC.setupKP method.
    private static String privateKeyStr = "30820941020100300D06092A864886F70D01010105000482092B308209270201000282020100809465D172D4CFBF244A9599E068E3942F40AD619B5CA8B326F13EF29FD7D20BC568838337D945D53C508F29628102EFB39765AB5959E789559178A55FA570CEEFCC9573CD72D6B7A70F9AD78D09DB30F5DF1366183C4F94533FD1562FB441B19705E6891BE17A628383078FAC237AD171E2BFF4885865FF635A31FAD9B09F55521A362EEAA1489B53DE24B0AD4BAFDD275608687493089A925E175FFAF81A1F01E278B4E53E5B4940DF495A348067906CD052B64BE8D09695442C1F5F541BAB9AEB7564DB54668F28EDADFDB21F513032C04927921E90E45F318C9BF776ACC584539410EBF06662B76ECBC8A98B2B379B86D6ABEEE50FE726C06529A8FBA84A359662DD089A21701B079B4F6182BABD289B3B17CE8B5BDC54FB0A2E3C89BDCDB0669E0FCDD26C2D0A82BDDC5732E3E9B90925FDB279487DCA47FF1F2CC184A454563D2BE26719422599A2039A341826788E72B7899834A75E17BEF5481993F909E48715E8F47C6E40F6C0357F1D0833709F4E68909A79A4C5CB703AE5353E78DE4F87FAD73ED306770B249E38DB1F6F5763C7C8321A00DBADD72893A7516067CD0D3FE83989566202DE1B58D2B462C72129E461A41ED69AD8AD3937EE70781392B4C5E16EA592288FCE0991D6038C182279A7E2C1F5C038C786128D84C79B510103105781047707B4243BC8F185979F7C31E54C14A05B080C2B8E600A0937EB02030100010282020053A93AFEA6EAD52997617829A11C5E4782DF6070CBF7E4447D28273F12C608836434F6AD205F9CD27BE626E0549980E19A46FDFE19AB27BDF2112F20DB34F84B8D37DE5E74E52DD45D3D08110C51C76EF9EBE5E15E0F8FF000A2DB806A95ACD0F26502755FD0BC22F153064E7340BA9F20ACDB1D2EC1E5CBE0474591E4A6C96568806994E9517BBEA5393B4241DFA7540C4E2C365AF3787BAA94D23CBF3D4331BDB62FB7F41938A8572F71B8E1C4529E644EC022A10DA0FAF9B05BCD25E7C2014C51BC169DA732FC1F33572C65037F7E0EE79231CF1F58435FB50BBA47AFCE06CE6CDB408F63E21A8523F030663089342B5BF6BDF438D2BA223AB917FC3D92679A84B30498875B26202CDF78BF68508509FFD75A6146EA5F86445A79C72B8D0F739907E16FD6C7DB36691889150852DA5A4B49FBF0DFBA6CFA2AA8DAF7696904AD826CF576E02B26B44F0DC15EB741E1FA03C2B856C05D5BF99A2C087757C7508234FF496BDE97F1500A03E8245792D064500CAAC6EA4C3A0C4B33C4D105E8C70815B5AB52156CC5A2CEE177B5CC5BC7FB5B1E7710A10D3938059BA7D639855D370A49AD9EB9F761337518F866B29795EC575D37F2ED752DE8BCDA0FCFA035204170FE8860CDBEA6A599B225DA831FFE0193D598FA3CC9933C7C861B241E7BB6D5FBC1986102C3B3F53478D8BC881A910A7DA2F6807D382D7ACBC3DC66E29A010282010100B92750FAA9605234B0A65CE12D2AC7BCDE10E3E611FBD07986BB404AE603FAAB37D6088EC9F0F1E1A8B43738F27F5EC608696D647570B523AF24F1A1BCEBACBF1AF2D78CC271D8D62A0CFB8D30F6CA8D81897C7A3E1F0B8796B59849B2DE2458F03332E11A629F0F03E7188838AEB7B7522F120175CFD1F0B0214967F3FDF014D61D5218EE20458BA2705D13CFBFF65B920FCFF47808C01CD856CE894D6DF4BBDFC1AF1056C1981848393E2F5152149708BD32A344086F9B1E319B1A90B1253369C5035B7BDAD10A5B1029CC490F217BF769055B72FFCF4A27D21D8F7345D518A342353771AAA82782011C55193CE6514DC9CDB73B0163730BA2A100BBA538810282010100B1C7654CFBFD1DC8DC830894E5C697F7E83F0C88A6AA0ED2C43C723C904DCEFABF7FB7A61E4861082A64922D04FF5B4A899A7F13F4CA2AEF74F063A76F7F32DC061060CEB59739A1F501D047B9AB923EECEC51B83FC325916B3489F3AA132304F627B55A17F1B179A7660EA8D1AD580993F29D0AAA6C990D8B93CB5AE14D6FAB188EA11F4DB895A6713542550525DC7579FA53486759D2E15BC5212180507E7E7A6D814E8F5ED99BD9FE09725D92C69723B0FE105B9CCB9EF3F7B14C3E40C72F204BCB105E503D22A5A7257FAA8ED8C1429FA168330ED83BD3FE9FE6B9BD0AA3CB4D166A29C56F1DB6C67A1C13EDECEFDF563AA410F0493FC24BA0BB217D9A6B0282010038591FCAF94B281982FD4E5CF52B04D894D89D1302BC192932F8BFCB4B8F4075652BCD34EF7E558EB092101053B4B1BA210B3CD08AF13F1F5A092B4466C36EB246584B833A15FDC0C7D165A90592C5F824C91BC9F427EC915A2B6FEA55F647278E0A76DC8CF420A62830E7856582BEC49ACD5A74794F42FC360E1B51F8AE7AA74CB665AAD2A59DA4AE4DF5F5B68F1C41A80509EBC3B01E0F694399DDAD63DE4C62FF85F0BA0676EC44E6AEE7259F8E469CD13F9CF27282CCB976AD567B5C7E0ED48CB1C5E0BEAA49B58708C1742697B12B8D99A4C82DD3FF24794CA7C0942B1331744FCFCCD6FC0FF1FFB688AB829E31763409584F2BD0014E34333D8EDDEC810282010042688A95BC57ABE59941B555F19342B74F6125EC71DD7A960EC9C99E880518B92009B46F70467740969D64E13E49A92F69C17590DDD31B40C1BCFE6CD040829E2001C437D32B7F52D973E8FAB207BE24955A1D98A6F0DDBAB98231B9FCA11366CA10C134BB570485BE1B68847576BC392FB3E427D4CBA64CA203FE659F5DCEC5E9F1758C7CFAE3A3FE0BF8104C50FD4E40D75A7EE464705AD06E0DD736D85AB822417F98FA0363644D8510C050E6001AFB312566B4E21849F336665B65B1CAF5F6A9795C4EEEC837860BAEFD4697FFAE099619B413C68ACDA67E29FB050CF1C987AAEF218F22FA43EE3FABE38B2A4864BE57B6A60CD1C57AF4B84D7D39A072AB02820100315C94674D8F7412EFFB9A58BBB5EF89732C2D23AC570B31D9D3511BF7966057EA9072FE4B954885CAAC33CCCAAD6AD8270F7FFACFBCF974DAF47F97F458B1266BE418D01145DA7A71CD0925FC08F06B864B0AC6932A28D675BDED35E2C355124770636419FD116C359884FC65A61C239353EFC3E80C2BD55C7AE2F1BE65509764836E23355E6D844ADB8B1BD867B6E9DF22AD1C97488E53CBA225626F01B907D82AE60431D3B45469CAE751F3D421EC1F9E999EC1BBF7E70DB076689896548BF6F25D6A5BC695D61D9E6F6629E54E36EEB10C60EF872AC51CF0185FB6075E7FD964DBE6C9A7C8121A4C2C6AC7314E1C0551F76673787B256A7FE5CEF0536B9B";
}
